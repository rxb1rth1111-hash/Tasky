<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta name="_csrf" th:content="${_csrf.token}"/>
  <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
  <title>Tasky - Tasks</title>
  <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
<!-- Navigation Bar -->
<div class="navbar">
  <button id="theme-toggle" class="theme-toggle">üåô Dark Mode</button>
  <a th:href="@{/tasks}" class="button">Tasks</a>
  <a th:href="@{/categories}">Categories</a>
  <a th:href="@{/logout}">Logout</a>
</div>

<div class="container">
  <h2>Your Tasks</h2>
  <div class="actions">
    <a th:href="@{/tasks/new}" class="button">Create New Task</a>
  </div>

  <!-- Today Tasks -->
  <div class="day">
    <h2>Today</h2>
    <div class="task-cards">
      <div th:each="task : ${todayTasks}" class="task-card" th:classappend="${task.priority}">
        <div class="task-header">
          <span class="priority-label" th:text="${task.priority}"></span>
          <h3 th:text="${task.title}">Task Title</h3>
        </div>
        <div class="task-body">
          <p>Status: <span th:text="${task.completed ? 'Completed' : 'Not Completed'}"></span></p>
          <p>Due: <span th:text="${#temporals.format(task.dueDate, 'yyyy-MM-dd')}">Due Date</span></p>
          <p>Reminder:
            <span th:if="${task.reminderTime != null}" th:text="${#temporals.format(task.reminderTime, 'yyyy-MM-dd HH:mm')}">Reminder Time</span>
            <span th:if="${task.reminderTime == null}">‚ùå</span>
          </p>
          <p>Category: <span th:text="${task.category != null} ? ${task.category.name} : 'Uncategorized'">Category</span></p>
          <div>
            <a href="#" onclick="toggleDescription(this); return false;">Show Description</a>
            <div class="task-desc" style="display: none;" th:text="${task.description}"></div>
          </div>
        </div>
        <div class="task-actions">
          <a th:href="@{'/tasks/edit/' + ${task.id}}" class="edit-btn">Edit</a>
          <a th:href="@{'/tasks/delete/' + ${task.id}}" class="delete-btn">Delete</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Tomorrow Tasks -->
  <div class="day">
    <h2>Tomorrow</h2>
    <div class="task-cards">
      <div th:each="task : ${tomorrowTasks}" class="task-card" th:classappend="${task.priority}">
        <div class="task-header">
          <span class="priority-label" th:text="${task.priority}"></span>
          <h3 th:text="${task.title}">Task Title</h3>
        </div>
        <div class="task-body">
          <p>Status: <span th:text="${task.completed ? 'Completed' : 'Pending'}"></span></p>
          <p>Due: <span th:text="${#temporals.format(task.dueDate, 'yyyy-MM-dd')}">Due Date</span></p>
          <p>Reminder:
            <span th:if="${task.reminderTime != null}" th:text="${#temporals.format(task.reminderTime, 'yyyy-MM-dd HH:mm')}">Reminder Time</span>
            <span th:if="${task.reminderTime == null}">‚ùå</span>
          </p>
          <p>Category: <span th:text="${task.category != null} ? ${task.category.name} : 'Uncategorized'">Category</span></p>
          <div>
            <a href="#" onclick="toggleDescription(this); return false;">Show Description</a>
            <div class="task-desc" style="display: none;" th:text="${task.description}"></div>
          </div>
        </div>
        <div class="task-actions">
          <a th:href="@{'/tasks/edit/' + ${task.id}}" class="edit-btn">Edit</a>
          <a th:href="@{'/tasks/delete/' + ${task.id}}" class="delete-btn">Delete</a>
        </div>
      </div>
    </div>
  </div>

  <!-- This Week Tasks -->
  <div class="day">
    <h2>This Week</h2>
    <div class="task-cards">
      <div th:each="task : ${thisWeekTasks}" class="task-card" th:classappend="${task.priority}">
        <div class="task-header">
          <span class="priority-label" th:text="${task.priority}"></span>
          <h3 th:text="${task.title}">Task Title</h3>
        </div>
        <div class="task-body">
          <p>Status: <span th:text="${task.completed ? 'Completed' : 'Pending'}"></span></p>
          <p>Due: <span th:text="${#temporals.format(task.dueDate, 'yyyy-MM-dd')}">Due Date</span></p>
          <p>Reminder:
            <span th:if="${task.reminderTime != null}" th:text="${#temporals.format(task.reminderTime, 'yyyy-MM-dd HH:mm')}">Reminder Time</span>
            <span th:if="${task.reminderTime == null}">‚ùå</span>
          </p>
          <p>Category: <span th:text="${task.category != null} ? ${task.category.name} : 'Uncategorized'">Category</span></p>
          <div>
            <a href="#" onclick="toggleDescription(this); return false;">Show Description</a>
            <div class="task-desc" style="display: none;" th:text="${task.description}"></div>
          </div>
        </div>
        <div class="task-actions">
          <a th:href="@{'/tasks/edit/' + ${task.id}}" class="edit-btn">Edit</a>
          <a th:href="@{'/tasks/delete/' + ${task.id}}" class="delete-btn">Delete</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Later Tasks -->
  <div class="day">
    <h2>Later</h2>
    <div class="task-cards">
      <div th:each="task : ${laterTasks}" class="task-card" th:classappend="${task.priority}">
        <div class="task-header">
          <span class="priority-label" th:text="${task.priority}"></span>
          <h3 th:text="${task.title}">Task Title</h3>
        </div>
        <div class="task-body">
          <p>Status: <span th:text="${task.completed ? 'Completed' : 'Pending'}"></span></p>
          <p>Due: <span th:text="${#temporals.format(task.dueDate, 'yyyy-MM-dd')}">Due Date</span></p>
          <p>Reminder:
            <span th:if="${task.reminderTime != null}" th:text="${#temporals.format(task.reminderTime, 'yyyy-MM-dd HH:mm')}">Reminder Time</span>
            <span th:if="${task.reminderTime == null}">‚ùå</span>
          </p>
          <p>Category: <span th:text="${task.category != null} ? ${task.category.name} : 'Uncategorized'">Category</span></p>
          <div>
            <a href="#" onclick="toggleDescription(this); return false;">Show Description</a>
            <div class="task-desc" style="display: none;" th:text="${task.description}"></div>
          </div>
        </div>
        <div class="task-actions">
          <a th:href="@{'/tasks/edit/' + ${task.id}}" class="edit-btn">Edit</a>
          <a th:href="@{'/tasks/delete/' + ${task.id}}" class="delete-btn">Delete</a>
        </div>
      </div>
    </div>
  </div>
</div>

<script th:src="@{/js/theme-toggle.js}"></script>
<script th:src="@{/js/notification.js}"></script>
<script>
  function toggleDescription(link) {
      const desc = link.nextElementSibling;
      desc.style.display = desc.style.display === 'none' ? 'block' : 'none';
      link.textContent = desc.style.display === 'none' ? 'Show Description' : 'Hide Description';
  }
</script>
</body>
</html>
